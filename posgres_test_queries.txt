CREATE SCHEMA IF NOT EXISTS storage;

CREATE TABLE IF NOT EXISTS storage.themes (
                        id text PRIMARY KEY NOT NULL,
                        name text
                        );


CREATE TABLE IF NOT EXISTS storage.units (
                        id text PRIMARY KEY NOT NULL,
                        title text,
                        theme_uuid text REFERENCES storage.themes (id) ON DELETE CASCADE NOT NULL,
                        unit_text text,
                        local_path text,
                        content_url text,
                        timestamp TIMESTAMP WITH TIME ZONE NOT NULL);

CREATE TABLE IF NOT EXISTS storage.index (;
                        id integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
                        theme_uuid text REFERENCES storage.themes (id) ON DELETE CASCADE NOT NULL,
                        parent_id text,
                        unit_uuid text REFERENCES storage.units (id) ON DELETE CASCADE NOT NULL);


insert into storage.themes (id, name) values ('67b722ed-8a6f-44db-8ebb-67466800564a', 'test_themes');

INSERT INTO storage.units ( id, title, theme_uuid, unit_text, local_path, content_url, timestamp )
VALUES ( 'e13811e8-4ace-4dea-bd7e-59cb12e67eeb', 'test title', '67b722ed-8a6f-44db-8ebb-67466800564a' , 'sdfsd sa asf fad fsda dfgdf', '', '', '1999-01-08 04:05:06 -8:00' ) ON CONFLICT DO NOTHING;

                             0    1       2           3          4            5          6
INSERT INTO storage.units ( id, title, theme_uuid, unit_text, local_path, content_url, timestamp )
VALUES ( 'e13811e8-4ace-4dea-bd7e-59cb24e67eeb', 'test title2', '67b722ed-8a6f-44db-8ebb-67466800564a' , 'sdfsd sa asf bdfad fsda dfgdf', '', '', 1728635778 ) ON CONFLICT DO NOTHING;


INSERT INTO storage.index ( theme_uuid, parent_id, unit_uuid ) VALUES ('67b722ed-8a6f-44db-8ebb-67466800564a', '', 'e13811e8-4ace-4dea-bd7e-59cb12e67eeb');


                  id                  |  name
--------------------------------------+---------
 67b722ed-8a6f-44db-8ebb-67466800564a | theme_a

                  id                  |   title    |              theme_uuid              |          unit_text          | local_path | content_url |       timestamp
--------------------------------------+------------+--------------------------------------+-----------------------------+------------+-------------+------------------------
 e13811e8-4ace-4dea-bd7e-59cb12e67eeb | test title | 67b722ed-8a6f-44db-8ebb-67466800564a | sdfsd sa asf fad fsda dfgdf |            |             | 2024-10-11 15:36:18+07

 id |              theme_uuid              | parent_id |              unit_uuid
----+--------------------------------------+-----------+--------------------------------------
  1 | 67b722ed-8a6f-44db-8ebb-67466800564a |           | e13811e8-4ace-4dea-bd7e-59cb12e67eeb

